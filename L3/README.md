**Инструменты поддержки промышленной разработки программного обеспечения**
## Лабораторная работа №3 (8 ч)

**Тема:** Автоматизация сборки, тестирования и развёртывания программного обеспечения в системе CI/CD.

**Цель работы:** Освоить базовые принципы CI/CD и их роль в промышленной разработке ПО. Получить практические навыки настройки автоматизированной сборки, тестирования и развертывания Java-проекта в системе CI/CD.

### Теоретические сведения

#### Что такое CI/CD

Непрерывная интеграция (Continuous Integration, CI) и непрерывная доставка (Continuous Delivery, CD) представляют собой набор принципов и практик, которые позволяют разработчикам чаще и надежнее развертывать изменения программного обеспечения.

Непрерывная интеграция (CI) - это автоматическая интеграция кода в репозиторий проекта. Цель CI - упростить объединение кода от разных разработчиков и быстро выявлять ошибки. Когда программист отправляет код в репозиторий, система запускает тесты.

Непрерывная доставка и развертывание (CD) обеспечивают автоматическую подготовку и доставку приложения в рабочее или тестовое окружение. 

CI/CD помогает быстрее выпускать новые версии программы, не тратя время на ручную сборку и развертывание, а значит - меньше ошибок и больше скорости в разработке.

CI/CD можно объяснить очень просто. Представьте, что у вас есть проект, над которым работает команда. Каждый пишет свой кусочек кода, и нужно, чтобы все это вместе работало без ошибок. CI - это когда кто-то добавляет изменения в репозиторий и автоматически запускается проверка: собирается проект, выполняются тесты, и сразу видно, не сломалось ли что-то. CD - это следующий шаг: после успешной проверки приложение автоматически упаковывается и отправляется на рабочий или тестовый сервер/облако, с которого приложение доступно пользователям.

#### GitHub Actions

GitHub Actions - это встроенная в GitHub платформа автоматизации, которая позволяет запускать рабочие процессы при наступлении событий в репозитории. По сути, это оркестратор задач, который реагирует на изменения кода и выполняет набор шагов: сборку, тестирование, упаковку артефактов и развертывание.

##### Кратко о возможностях и типовых сценариях

GitHub Actions предоставляет хостируемые виртуальные машины с предустановленными инструментами, кэширование зависимостей, секреты и переменные окружения, хранение артефактов и тонкую оркестрацию шагов. 

В контексте Java-проекта с Gradle это означает возможность автоматически запускать wrapper-скрипт, прогонять юнит-тесты, собирать jar/war, а затем деплоить на целевую платформу.

Сердцем этой автоматизации является workflow-файл.

##### Что такое Workflow-файл

Workflow описывается в YAML-файле (`.yml` или `.yaml`) внутри каталога `.github/workflows`. В этом файле вы описываете, что нужно сделать и когда это нужно сделать. Например: когда кто-то делает `push` в ветку `main`, что нужно сделать: взять код, установить Java, запустить команду `./gradlew build`.

Ниже представлен пример workflow-файла:

```YAML
# .github/workflows/build.yml

# 1. Название Workflow
name: Java CI with Gradle

# 2. Триггер: запускать при push в ветку main
on:
  push:
    branches: [ "main" ]

# 3. Работы (задания)
jobs:
  # 4. Название работы (job_id) - "build"
  build:

    # 5. На какой ОС запускать
    runs-on: ubuntu-latest

    # 6. Шаги, которые нужно выполнить
    steps:
      # 7. Шаг 1: "uses" - скачать код репозитория
      - name: Checkout repository
        uses: actions/checkout@v4

      # 8. Шаг 2: "uses" - установить Java (JDK 17)
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin' # Популярный дистрибутив Java

      # 9. Шаг 3: "run" - даем права на выполнение Gradle-скрипту
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      # 10. Шаг 4: "run" - запускаем сборку и тесты
      - name: Build with Gradle
        run: ./gradlew build
```

Разберем подробнее ключевые блоки:
- `name` - название вашего workflow. Оно будет отображаться во вкладке Actions в GitHub
- `on` - событие, при наступлении которого запускается workflow
- `jobs` - контейнер для всех работ (заданий), которые нужно выполнить
	- `<job_id>` - название работы (например, `build`)
	- `runs-on` - виртуальная машина (ОС), на котором будут выполняться задачи. GitHub предоставляет их бесплатно
	- `steps` - последовательность шагов (команд), которые нужно выполнить
		- каждый шаг начинается с символа `-`
		- `uses` - использует готовое действие (Action), созданное сообществом или GitHub. Это похоже импорт библиотеки
		- `run` - выполняет команду в командной строке (shell) виртуальной машины

##### Создание Workflow-файла

1. Зайдите в ваш репозиторий на GitHub.
2. Нажмите на вкладку **Actions** (она находится рядом с **Code**, **Issues**, **Pull Requests**).
3. GitHub проанализирует ваш код и, увидев Java/Gradle, сам предложит вам шаблон.
4. Найдите карточку **Java with Gradle** и нажмите **Configure**.
5. GitHub откроет редактор и создаст для вас файл `.yml` с уже готовым кодом. *Примечание:* GitHub-шаблон может быть сложнее, чем вам нужно. Вы можете полностью удалить его содержимое и вставить пример, который приведен выше, чтобы лучше понять основы.
6. Когда вы закончите редактирование, нажмите на кнопку **Commit changes**.
7. Готово! Workflow-файл сохранен в `.github/workflows/`. Перейдите снова на вкладку **Actions** - вы увидите, как ваш первый workflow уже запущен.

### Задание

Разработать Java-приложение согласно варианта (по списку в журнале) со сборщиком Gradle. Настроить GitHub Actions workflow для автоматической сборки проекта, запуска тестов и других действий согласно варианта.

**Требования к ПО:**
- код должен быть логически разделен на классы и пакеты
- весь код бизнес-логики должен быть задокументирован с использованием JavaDoc
- весь код бизнес-логики должен быть покрыт тестами

**Общие требования:**
- использовать Git согласно методике, описанной в л.р. №1 (т.е. использовать ветки, поддерживать версионность, описывать изменения)
	- если нет должной истории проекта или временной промежуток между начальной и конечной версии проекта слишком короткий, то л.р. считается невыполненной
	- к проекту должна быть документация по развертыванию и запуску
	- в истории коммитов в поле "автор" должны быть указаны Ваши фамилия и имя

### Варианты

Текст

### Отчет по лабораторной работе должен содержать

1. Цель и задачи работы.
2. Структура проекта и используемые зависимости.
3. Список тестов и их описание.
4. Скриншоты с результатами прохожождения тестов и работы приложения.
5. Описание workflow-файла.
6. Вывод по выполненной работе.

### Список вопросов на защиту

1. Что такое CI/CD и зачем оно нужно?
2. Какие этапы обычно включает pipeline CI/CD?
3. Что такое GitHub Actions и как он работает?
4. Что такое workflow и job в GitHub Actions?
5. Какие преимущества использования Gradle по сравнению с Maven?
6. Что такое артефакт сборки?
7. Что такое unit‑тесты и зачем они нужны?
8. Что такое Javadoc и зачем его использовать?
9. Какие события могут запускать workflow в GitHub Actions?
10. Что такое secrets в GitHub Actions?